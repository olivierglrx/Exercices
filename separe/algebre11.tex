\subsection{Fraction Rationnelle $Q_n(\tan(\theta)) = \tan(n\theta)$ (Pb) }
\begin{exercice}
Cet exercice propose d'étudier une suite de fractions rationnelles, c'est-à-dire des fonctions définies comme quotients de deux fonctions polynomiales. Plus précisément, on considère les suites de polynômes $\suite{P}$ et $\suite{Q}$ définies par 
$$
\left\{\begin{array}{ccc}
P_0 &=& 0\\
Q_0 &=& 1
\end{array}
 \right. \quadet \forall n\in \N, \, 
\left\{\begin{array}{ccc}
P_{n+1} &=& P_n + X Q_n\\
Q_{n+1} &=& Q_n -XP_n
\end{array}
 \right. 
$$
et on note $\suite{R}$ la suite de fonctions définie par $\forall n\in \N$ 
$R_n : x\mapsto\frac{P_n(x)}{Q_n(x)}.$

\begin{enumerate}
\item Déterminer $R_0,R_1,R_2 $ et $R_3$ ainsi que leurs domaines de défintion. 
\item Calculer pour tout $n\in \N$, $Q_n(0)$. 
\item Justifier que pour tout $n\in \N$, le domaine de définition de $R_n$ est de la forme $\R\setminus E_n$ où $E_n$ est un ensemble fini de nombres réels. 
%\item Démontrer que pour tout $n\in \N$, les coefficients de $P_n$ et $Q_n$ sont des entiers relatif. 
\item Démontrer que $\forall n \in \N,\, Q_n +iP_n = (1+iX)^n $.
\item Pour cette question, on fixe $n\in \N$ et $\theta \in \left] -\frac{\pi}{2},\frac{\pi}{2}\right[.$
\begin{enumerate}
\item Ecrire le nombre complexe $(1+i \tan(\theta))^n$ sous forme algébrique. 
\item En déduire que $P_n(\tan(\theta) )= \frac{\sin(n\theta)}{\cos^n(\theta)}$ et $Q_n(\tan(\theta) )= \frac{\cos(n\theta)}{\cos^n(\theta)}$.
\item Justifier proprement que $E_n = \left\{ \tan\left( \frac{m\pi}{2n}\right)\,|\, \text{ $m$ entier impair tel que $-n<m<n$ } \right\}.$ 
\item Montrer que $\forall  \theta \in \left] -\frac{\pi}{2n},\frac{\pi}{2n}\right[,\, R_n(\tan(\theta)) =\tan(n\theta)$
\end{enumerate}
\item Pour cette question, on fixe $n\in \N$ et on suppose qu'il existe deux polynomes $(P,Q) \in ( \R[X])^2$ et une fraction rationnelle $R : x\mapsto \frac{P(x)}{Q(x)}$ telle que $\forall  \theta \in \left] -\frac{\pi}{2n},\frac{\pi}{2n}\right[,\, R(\tan(\theta)) =\tan(n\theta)$
\begin{enumerate}
\item Montrer que  $\forall  \theta \in \left] -\frac{\pi}{2n},\frac{\pi}{2n}\right[,\, (PQ_n- QP_n)(\tan(\theta) ) =0$.
\item En déduire que $PQ_n- QP_n=0$ puis que $R=R_n$. 
\end{enumerate}
\end{enumerate}

\end{exercice}



\begin{correction}
\begin{enumerate}
\item Calculons tout d'abord $P_i$ et $Q_i$ pour $i\in \{1,2,3\} $. 

$\left\{\begin{array}{ccl}
P_{1} &=& P_0 + X Q_0= X\\
Q_{1} &=& Q_0 -XP_0=1
\end{array}
 \right. \quadet \left\{\begin{array}{ccl}
P_{2} &=& P_1 + X Q_1= 2X\\
Q_{2} &=& Q_1 -XP_1=1-X^2
\end{array}
 \right. $
 \vsec
 
 $\left\{\begin{array}{ccl}
P_{3} &=& P_2 + X Q_2= 3X-X^3\\
Q_{3} &=& Q_2 -XP_2=1-X^2-2X^2 = 1-3X^2
\end{array}
 \right. $
 \vsec 

On obtient 
$$R_0=\frac{P_0}{Q_0}=0 \quadet R_1 = X \quadet R_2 =\frac{2X}{1-X^2} \quadet  R_3=\frac{3X-X^3}{1-3X^2}.$$

Les ensembles de définitions respectifs sont : 
$$D_0 = \R\quadet D_1 = \R \quadet D_2 = \R\setminus\{ \sqrt{2},-\sqrt{2}\}\quadet D_3 = \R\setminus\{ \frac{1}{\sqrt{3}},-\frac{1}{\sqrt{3}}\}$$
\item On montre par récurrence que pour tout $n\in \N$, $Q_n(0)= 1$. Pour $n=0$ c'est vrai par définition de $Q_0$. L'hérédité se montre grâce à la relation de récurrence $Q_{n+1} =Q_n -XP_n$, en évaluant en $0$ on obtient $Q_{n+1} (0) = Q_n(0) -0 P_n(0 ) = Q_n(0)=1$. 

\item L'ensemble de définition de $R_n$ est l'ensemble $\{ x \in \R\, |\, Q_n(x)\neq 0\}$, le complémentaire des racines réelles de $Q_n$. 
Or un polynôme non-nul n'a qu'un nombre fini de racines. D'après la question précédente $Q_n$ n'est pas le polynôme nul donc $E_n =\{ Q_n(x) = 0\}$ est un ensemble fini. 
  


\item On montre la proposition par récurrence. 
Pour tout $n\in \N$ on note $\cK(n): "  Q_n +iP_n = (1+iX)^n $". 

Pour $n=0$ on a $Q_0+iP_0 = 1$ par définition de $Q_0$ et $P_0$ et on a $(1+iX)^0 = 1$. 
$\cK(0)$ est donc vrai. 

On suppose que la propriété $\cK(n)$ est vraie pour un certain entier $n$. On a alors 
$Q_{n+1} +iP_{n+1} = (Q_n -X P_n) +i (P_n +XQ_n)$ par définition des suites de polynômes $\suite{P}$ et $\suite{Q}$ 
On  a donc 
\begin{align*}
Q_{n+1} +iP_{n+1} &= (Q_n +iP_n)+X(iQ_n-P_n)\\
							&= (Q_n +iP_n)+iX(Q_n+iP_n)
\end{align*}
car $-1 = i^2$. En utilisant l'hypothèse de récurrence on obtient:
\begin{align*}
Q_{n+1} +iP_{n+1} &= (1+iX)^n+iX (1+iX)^n\\
								&=(1+iX) (1+iX)^n\\
								&=(1+iX)^{n+1} 
\end{align*}
La propriété $\cK$ est donc héréditaire. 

Par récurrence, elle est vraie pour tout $n\in \N$. 

\item \begin{enumerate}
\item 
\begin{align*}
(1+i\tan(\theta))^n &= \left( \frac{\cos(\theta) + i\sin(\theta)}{\cos(\theta)}\right)^n\\
								&=\left( \frac{\exp(i\theta)}{\cos(\theta)}\right)^n\\
								&= \frac{\exp(in\theta)}{\cos^n(\theta)}\\
								&= \frac{\cos(n\theta) +i\sin(n\theta)}{\cos^n(\theta)}\\
								&= \frac{\cos(n\theta) }{\cos^n(\theta)}+i \frac{\sin(n\theta)}{\cos^n(\theta)}
\end{align*}

\item En évaluant la relation obtenue à la question 5) en $\tan(\theta)$ on obtient : 
$$Q_n(\tan(\theta))+iP_n(\tan(\theta))  = (1+i\tan(\theta))^n.$$ Or d'après la question 6a)
$(1+i\tan(\theta))^n= \frac{\cos(n\theta) }{\cos^n(\theta)}+i \frac{\sin(n\theta)}{\cos^n(\theta)}$. On identifie ensuite partie réelle et partie imaginaire et on trouve 
$$P_n(\tan(\theta) )= \frac{\sin(n\theta)}{\cos^n(\theta)} \quadet Q_n(\tan(\theta) )= \frac{\cos(n\theta)}{\cos^n(\theta)}.$$

\item On a vu à la question 3 que $E_n=\{ x\in \R\, |\, Q_n(x) = 0\}$. Comme $\tan $ est une bijection $]-\frac{\pi}{2},\frac{\pi}{2}[$ dans $\R$, pour tout $x\in E_n$ il existe $\theta \in ]-\frac{\pi}{2},\frac{\pi}{2}[$ tel que $x= \tan(\theta)$.  D'après la question 6)b) on  a alors 
  $x\in E_n$ si et seulement si $\frac{\cos(n\theta)}{\cos^n(\theta)}=0$ ce qui équivaut à $\cos(n\theta ) = 0$, soit $n\theta \equiv   \frac{\pi}{2}\,[\pi]$. 
  
  Ainsi $\theta \equiv  \frac{\pi}{2n}\,[\frac{\pi}{n}]$ et comme $\theta \in ]-\frac{\pi}{2},\frac{\pi}{2}[$ on a 
  $$\theta \in \left\{ \frac{\pi+2k\pi }{2n} \, |\, k\in \Z \right\} \cap ]-\frac{\pi}{2},\frac{\pi}{2}[.$$  On trouve alors 
 \begin{align*}
  \theta &\in \left\{ \frac{(2k+1)\pi }{2n} \, |\, k\in \Z \right\}\cap ]-\frac{\pi}{2},\frac{\pi}{2}[ \\
  \theta & \in \left\{ \frac{m\pi }{2n} \, |\, \text{$m$ impair} \right\}\cap ]-\frac{\pi}{2},\frac{\pi}{2}[ \\
  \theta &\in \left\{ \frac{m\pi }{2n} \, |\, -n<m<n, \, \,  \text{$m$ impair}  \right\}
\end{align*}  
La dernière égalité s'obtient en résolvant les inégalités : 
$-\frac{\pi}{2}<\frac{m\pi }{2n} <\frac{\pi}{2}$
  

 En revenant à la variable $x$, on a :
 \begin{align*}
 	 x	& \in \{ \tan\left(   \frac{m\pi }{2n}  \right) \, |\, -n<m<n,\,\,  \text{$m$ impair}\}  
\end{align*}  
%
%\underline{Méthode 2}
%
%Il y a une solution complétement différente.  D'après la question 5b, on sait que pour tout $k\in \Z$ on a :
%
%$$Q_n\left(\tan\left(\frac{\left(2k+1\right)\pi }{2n}\right) \right) =\frac{\cos\left(n\frac{\left(2k+1\right)\pi }{2n}\right)}{\cos^n\left(\frac{\left(2k+1\right)\pi }{2n}\right)}= \frac{\cos\left(\frac{\left(2k+1\right)\pi }{2}\right)}{\cos^n\left(\frac{\left(2k+1\right)\pi }{2n}\right)}$$
%
%Et comme $\cos\left(\frac{\left(2k+1\right)\pi }{2}\right)=0$ on a bien :
%$$Q_n\left(\tan\left(\frac{\left(2k+1\right)\pi }{2n}\right) \right) =0$$
%Comme $\tan $ est $\pi$-périodique, on obtient $n$ racines différentes pour $Q_n : \{ \tan\left(   \frac{(2k+1)\pi }{2n}  \right) \, |\, -n<k<n\} \\$
%

\item Remarquons que  $\forall  \theta \in \left] -\frac{\pi}{2n},\frac{\pi}{2n}\right[, $ $\R_n\left(\tan\left(\theta\right)\right) $ est bien définie d'après la question précédente. 
  
  On a  ainsi, 
$\forall  \theta \in \left] -\frac{\pi}{2n},\frac{\pi}{2n}\right[, $
\begin{align*}
R_n(\tan(\theta)) &= \frac{P_n(\tan(\theta)}{Q_n(\tan(\theta))}\\ 
						&= \frac{\frac{\sin(n\theta)}{\cos^n(\theta)}
}{\frac{\cos(n\theta)}{\cos^n(\theta)}}\\ 
						&=\tan(n\theta)
\end{align*}

\end{enumerate}
\item
\begin{enumerate}
\item $\forall  \theta \in \left] -\frac{\pi}{2n},\frac{\pi}{2n}\right[, $
on a 
$$R(\tan(\theta)) =R_n(\tan(\theta)$$
Donc, 
$$\frac{P_n}{Q_n} (\tan(\theta)) =\frac{P}{Q} (\tan(\theta))$$
En multipliant de par et d'autres par $QQ_n (\tan(\theta))$ on obtient : 
$$P_n Q (\tan(\theta))=P Q_n (\tan(\theta))$$
et donc 
$$(P_nQ -PQ_n)(\tan(\theta))=0$$
\item Le polynome $P_nQ -PQ_n$  s'annule en une infinité de valeur d'après la question précédente, c'est donc le polynôme nul. Donc 
$P_n Q - P Q_n = 0$ (je n'ai pas 'simplifier' par $\tan(\theta)) \neq 0$, ici j'utilise quelque chose de complétement différent. On a évalué en $\tan(\theta)$ ce n'est pas un produit mais une composition) 

On obtient donc $P_n Q= PQ_n$ (égalité entre polynomes) et donc 
$\frac{P_n}{Q_n} =\frac{P}{Q}$ (égalité entre fraction rationnelle). 

\end{enumerate}
\end{enumerate}
\end{correction}